<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="A cool layout.">
        <meta name="keywords" content="R">
        <meta name="author" content="ivanhanigan based on rich-iannone">

        <link rel="apple-touch-icon" sizes="57x57" href="icon/apple-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="icon/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="icon/apple-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="icon/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="icon/apple-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="icon/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="icon/apple-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="icon/apple-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="icon/apple-icon-180x180.png">
        <link rel="icon" type="image/png" sizes="192x192"  href="icon/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="96x96" href="icon/favicon-96x96.png">
        <link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
        <link rel="manifest" href="icon/manifest.json">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="icon/ms-icon-144x144.png">
        <meta name="theme-color" content="#ffffff">

        <title>
        Spatiotemporal multilevel modelling
        </title>

        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/docs.min.css" rel="stylesheet">

        <script src="js/ie-emulation-modes-warning.js"></script>

    </head>

<body>
    <a id="skippy" class="sr-only sr-only-focusable" href="#content"><div class="container"><span class="skiplink-text">Skip to main content</span></div></a>

    <!-- Docs master nav -->
    <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="index.html" class="navbar-brand">Spatiotemporal multilevel modelling</a>
            </div>
            <!-- <nav class="collapse navbar-collapse bs-navbar-collapse"> -->
            <!--     <ul class="nav navbar-nav"> -->
            <!--         <li> -->
            <!--           <a href="docs.html">Start</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="io.html">I/O</a> -->
            <!--         </li> -->
            <!--         <li class="active"> -->
            <!--           <a href="graphviz_and_mermaid.html">Graphviz/Mermaid</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="ndfs_edfs.html">NDFs/EDFs</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="graph_creation.html">Graph Creation</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="selections.html">Selections</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="traversals.html">Traversals</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="inspection.html">Inspection</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="modification.html">Modification</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="deposit_values.html">Deposits</a> -->
            <!--         </li> -->
            <!--         <li> -->
            <!--           <a href="graph_series.html">Series</a> -->
            <!--         </li> -->
            <!--     </ul> -->
            <!-- </nav> -->
        </div>
    </header>

    <!-- Docs page layout -->
    <div class="bs-docs-header" id="content">
        <div class="container">
        <h1>Spatiotemporal multilevel modelling.</h1>
 <p>An open notebook by Ivan Hanigan.</p>
        </div>
    </div>

    <div class="container bs-docs-container">
            <div class="col-md-3" role="complementary">
                <!-- <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm"> -->
                <!--     <ul class="nav bs-docs-sidenav"> -->
                <!--         <li> -->
                <!--             <a href="#graphviz">Graphviz</a> -->
                <!--             <ul class="nav"> -->
                <!--                 <li><a href="#diagrammer-implementation">DiagrammeR Implementation</a></li> -->
                <!--                 <li><a href="#defining-a-graphviz-graph">Defining a Graphviz Graph</a></li> -->
                <!--                 <li><a href="#statements">Statements</a></li> -->
                <!--                 <li><a href="#subgraphs-and-clusters">Subgraphs and Clusters</a></li> -->
                <!--             </ul> -->
                <!--         </li> -->
                <!--         <li> -->
                <!--             <a href="#attributes">Graphviz Attributes</a> -->
                <!--             <ul class="nav"> -->
                <!--                 <li><a href="#node-attributes">Node Attributes</a></li> -->
                <!--                 <li><a href="#edge-attributes">Edge Attributes</a></li> -->
                <!--                 <li><a href="#colors">Colors</a></li> -->
                <!--                 <li><a href="#node-shapes">Node Shapes</a></li> -->
                <!--                 <li><a href="#arrow-shapes">Arrow Shapes</a></li> -->
                <!--             </ul> -->
                <!--         </li> -->
                <!--         <li> -->
                <!--             <a href="#substitution">Graphviz Substitution</a> -->
                <!--             <ul class="nav"> -->
                <!--                 <li><a href="#how-it-works">How It Works</a></li> -->
                <!--                 <li><a href="#examples">Examples</a></li> -->
                <!--             </ul> -->
                <!--         </li> -->
                <!--         <li> -->
                <!--             <a href="#graphviz-layouts">Graphviz Layouts</a> -->
                <!--             <ul class="nav"> -->
                <!--                 <li><a href="#the-layouts">The Layouts</a></li> -->
                <!--                 <li><a href="#dot">dot</a></li> -->
                <!--                 <li><a href="#neato">neato</a></li> -->
                <!--                 <li><a href="#twopi">twopi</a></li> -->
                <!--                 <li><a href="#circo">circo</a></li> -->
                <!--             </ul> -->
                <!--         </li> -->
                <!--         <li> -->
                <!--             <a href="#mermaid">mermaid</a> -->
                <!--             <ul class="nav"> -->
                <!--                 <li><a href="#mermaid-basics">mermaid Basics</a></li> -->
                <!--                 <li><a href="#defining-a-mermaid-graph">Defining a mermaid Graph</a></li> -->
                <!--                 <li><a href="#node-shape-and-text">Node Shape and Text</a></li> -->
                <!--                 <li><a href="#mermaid-sequence-diagrams">mermaid Sequence Diagrams</a></li> -->
                <!--             </ul> -->
                <!--         </li> -->
                <!--     </ul> -->
                <!--     <a class="back-to-top" href="#top">Back to top</a> -->
                <!-- </nav> -->
                <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
                    <ul class="nav bs-docs-sidenav">
                        <li>
                            <a href="#overview">Overview</a>
                            <ul class="nav">
                                <li><a href="#scope">scope</a></li>
                                <li><a href="#datainventory">Data Inventory</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#folderstructure">Folder Structure</a>
                            <ul class="nav">
                                <li><a href="#project">Project</a>
                                    <ul class="nav">
                                        <li><a href="#dataset">Dataset</a></li>
                                        <li><a href="#entity">Entity</a></li>
                                    </ul>
                                </li>                                
                                <li><a href="#version">Version control</a></li>
                                <li><a href="#spatially-structured-timeseries">Spatially structured timeseries</a></li>
                            </ul>
                        </li>
                    </ul>
                    <a class="back-to-top" href="#top">Back to top</a>
                </nav>

            </div>

    <div class="container bs-docs-container">
        <div class="row">
            <div class="col-md-9" role="main">
                <div class="bs-docs-section">
                    <h1 id="introduction" class="page-header">Introduction</h1>
                       <h2 id="overview">Overview</h2>
                       <p> will introduce what multi-level data and models are and why they are useful in epidemiology contexts.
We begin with the general linear model framework GLM and then move to mixed-effects models.  It is important to realise that these models are called different things in different disciplines: (generalized) linear mixed (effects) models (GLMM), hierarchical (generalized) linear models, etc. The terminology for the model parameters is equally diverse, usually including the terms random effects and fixed effects.  So we focus on the key concepts.</p>

<p>We will cover what is a Random Effect and how it differs from a Fixed effect.  Some example syntax in R (on a secure website portal we have configured) and Stata will show how to get a handle on models that have random intercepts and additionally, random slopes.</p>

<p>We will spend a little time talking about how to partition variation and get estimates of the random and fixed effects.
An important element will be our discussion of similarities between mixed-effects models with basic regression.
There will also be brief discussion of extending the regression to non-gaussian responses (GLMERs).</p>

<p>We will discuss how to interpret these results in a population health context.</p>

<p>An online analysis server (Rstudio in a web browser) and data repository (geoserver) are also provided</p> 
<iframe style="border: none;" height="400" width="600" src="http://115.146.93.225:8181/geoexplorer/viewer/#maps/3"></iframe>

                           <h3 id="scope">Scope</h3>
                           <p>This is a thing</p>
                           <h3 id="datainventory">Data Inventory</h3>
                           <p>This is a thing</p>
                    
                       <h2 id="folderstructure">Folder Structure</h2>
                       <p>The  report by Noble.</p>
                           <h3 id="project">Project</h3>
                           <p>This is a thing</p>
                           <h3 id="dataset">Dataset</h3>
                           <p>This is a thing</p>
                               <h4 id="entity">Entity</h3>
                               <p>This is a thing</p>
                           <h3 id="version">Version Control</h3>
                           <p>This is a thing</p>

                    <div class="bs-example">
                        <img src="img/Pipeline.png" class="img-responsive center-block">
                    </div>
<p> This is some R code </p>
                    <div>
                        <pre><code class="prettyprint">dat <- rnorm(1000,1,2)</code></pre></div>
                    </div>

<h2 id="spatially-structured-timeseries">Spatially structured timeseries</h2>


<p>I will use the NMMAPSlite datasets for a simple example of what I describe as "Spatially Structured Timeseries" as opposed to "Spatio-Temporal" which I think more explicitly includes spatial structure in the model.
</p>


<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Outcome Data</h3>
<div class="outline-text-3" id="text-2-1">


</div>

<div id="outline-container-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> Original Data</h4>
<div class="outline-text-4" id="text-2-1-1">




<pre class="src src-R"><span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">http://cran.r-project.org/web/packages/NMMAPSlite/index.html</span>
<span style="color: #2aa198;">Package &#8216;NMMAPSlite&#8217; was removed from the CRAN repository.</span>
<span style="color: #2aa198;">Formerly available versions can be obtained from the archive.</span>
<span style="color: #2aa198;">Archived on 2013-05-11 at the request of the maintainer.</span>

<span style="color: #2aa198;">The Archived versions do not seem to work either.</span>

<span style="color: #2aa198;">That is such a shame, lucky I saved some of the data using the following code:</span>
<span style="color: #2aa198;">"</span>
</pre>






<pre class="src src-R">   
<span style="color: #586e75;">#### </span><span style="color: #586e75;">Code: get nmmaps data</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">func</span>
<span style="color: #859900; font-weight: bold;">if</span>(!<span style="color: #268bd2; font-weight: bold;">require</span>(NMMAPSlite)) install.packages(<span style="color: #2aa198;">'NMMAPSlite'</span>);<span style="color: #268bd2; font-weight: bold;">require</span>(NMMAPSlite)

<span style="color: #586e75;">######################################################</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">load  </span>
setwd(<span style="color: #2aa198;">'data'</span>)
initDB(<span style="color: #2aa198;">'data/NMMAPS'</span>) <span style="color: #586e75;"># </span><span style="color: #586e75;">this requires that we connect to the web,</span>
                      <span style="color: #586e75;"># </span><span style="color: #586e75;">so lets get local copies</span>
setwd(<span style="color: #2aa198;">'..'</span>)
cities <span style="color: #268bd2; font-weight: bold;">&lt;-</span> getMetaData(<span style="color: #2aa198;">'cities'</span>)
head(cities)
citieslist <span style="color: #268bd2; font-weight: bold;">&lt;-</span> cities$cityname
<span style="color: #586e75;"># </span><span style="color: #586e75;">write out a few cities for access later</span>
<span style="color: #859900; font-weight: bold;">for</span>(city_i <span style="color: #859900; font-weight: bold;">in</span> citieslist[sample(1:nrow(cities), 9)])
{
 city <span style="color: #268bd2; font-weight: bold;">&lt;-</span> subset(cities, cityname == city_i)$city
 data <span style="color: #268bd2; font-weight: bold;">&lt;-</span> readCity(city)
 write.table(data, file.path(<span style="color: #2aa198;">'data'</span>, paste(city_i, <span style="color: #2aa198;">'.csv'</span>,sep=<span style="color: #2aa198;">''</span>)),
 row.names = F, sep = <span style="color: #2aa198;">','</span>)
}
<span style="color: #586e75;"># </span><span style="color: #586e75;">these are all tiny, go some big ones</span>
<span style="color: #859900; font-weight: bold;">for</span>(city_i <span style="color: #859900; font-weight: bold;">in</span> c(<span style="color: #2aa198;">'New York'</span>, <span style="color: #2aa198;">'Los Angeles'</span>, <span style="color: #2aa198;">'Madison'</span>, <span style="color: #2aa198;">'Boston'</span>))
{
 city <span style="color: #268bd2; font-weight: bold;">&lt;-</span> subset(cities, cityname == city_i)$city
 data <span style="color: #268bd2; font-weight: bold;">&lt;-</span> readCity(city)
 write.table(data, file.path(<span style="color: #2aa198;">'data'</span>, paste(city_i, <span style="color: #2aa198;">'.csv'</span>,sep=<span style="color: #2aa198;">''</span>)),
 row.names = F, sep = <span style="color: #2aa198;">','</span>)
}
</pre>


            </div>
        </div>

        <footer class="bs-docs-footer" role="contentinfo">
            <div class="container">
                <div class="bs-docs-social">
                    <!-- <ul class="bs-docs-social-buttons"> -->
                    <!--     <li> -->
                    <!--         <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=rich-iannone&amp;repo=DiagrammeR&amp;type=watch&amp;count=true" width="90" height="20" title="Star on GitHub"></iframe> -->
                    <!--     </li> -->
                    <!--     <li> -->
                    <!--         <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=rich-iannone&amp;repo=DiagrammeR&amp;type=fork&amp;count=true" width="90" height="20" title="Fork on GitHub"></iframe> -->
                    <!--     </li> -->
                    <!-- </ul> -->
                    <ul class="bs-docs-social-buttons">
                        <li class="follow-btn">
                            <a href="https://twitter.com/ivanhanigan" class="twitter-follow-button" data-link-color="#0069D6" data-show-count="true">Follow @ivanhanigan</a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- <div class="container"> -->
            <!--     <p>Designed and built by Richard Iannone <a href="https://twitter.com/riannone" target="_blank">@riannone</a>.</p> -->
            <!--     <p>Valuable contributions by Kent Russell <a href="https://twitter.com/timelyportfolio" target="_blank">@timelyportfolio</a>, JJ Allaire <a href="https://twitter.com/rstudio" target="_blank">@rstudio</a>, and MichaÃ«l Benesty <a href="https://twitter.com/pommedeterre33" target="_blank">@pommedeterre33</a>.</p> -->
            <!--     <p>Code licensed under MIT.</p> -->
            <!--     <ul class="bs-docs-footer-links text-muted"> -->
            <!--         <li>Currently v0.8.2</li> -->
            <!--         <li>&middot;</li> -->
            <!--         <li><a href="https://github.com/rich-iannone/DiagrammeR">GitHub</a></li> -->
            <!--         <li>&middot;</li> -->
            <!--         <li><a href="https://github.com/rich-iannone/DiagrammeR/issues">Issues</a></li> -->
            <!--         <li>&middot;</li> -->
            <!--         <li><a href="https://github.com/rich-iannone/DiagrammeR/releases">Releases</a></li> -->
            <!--     </ul> -->
            <!-- </div> -->
        </footer>


        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="./js/bootstrap.min.js"></script>
        <script src="./js/docs.min.js"></script>
        <script src="./js/ie10-viewport-bug-workaround.js"></script>
        <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>

        <script>
          window.twttr = (function (d,s,id) {
            var t, js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return; js=d.createElement(s); js.id=id; js.async=1;
            js.src="https://platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
            return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
          }(document, "script", "twitter-wjs"));
        </script>

    </body>
</html>
